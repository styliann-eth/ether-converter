# Minimal entities to index deposits/withdrawals normalized to WETH,
# store per-block redemption rates, and keep per-user aggregates.

type Pool @entity(immutable: true) {
  id: ID!
  lpToken: Bytes
  tokens: [Bytes!]!
  createdBlock: BigInt
}

type Deposit @entity(immutable: true) {
  id: ID!
  provider: Bytes!
  pool: ID!
  token: Bytes!
  tokenIndex: Int!
  amountRaw: BigInt!
  amountWETH: BigDecimal!
  rateToETHId: ID
  blockNumber: BigInt!
  blockTimestamp: BigInt!
  transactionHash: Bytes!
}

type Withdrawal @entity(immutable: true) {
  id: ID!
  provider: Bytes!
  pool: ID!
  token: Bytes!
  tokenIndex: Int!
  amountRaw: BigInt!
  amountWETH: BigDecimal!
  rateToETHId: ID
  blockNumber: BigInt!
  blockTimestamp: BigInt!
  transactionHash: Bytes!
}

type OracleRate @entity(immutable: true) {
  id: ID!
  token: Bytes!
  blockNumber: BigInt!
  blockTimestamp: BigInt!
  rateToETH: BigDecimal!
  source: String
}

type User @entity(immutable: false) {
  id: ID!
  totalDepositedWETH: BigDecimal!
  totalWithdrawnWETH: BigDecimal!
  netLossWETH: BigDecimal!
  lastUpdatedBlock: BigInt
}
